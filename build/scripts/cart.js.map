{
  "version": 3,
  "sources": ["source/scripts/utils.js", "source/scripts/render-products.js", "source/scripts/cart.js"],
  "sourcesContent": ["const isEscapeKey = (evt) => evt.key === 'Escape';\n\nconst debounce = (callback, timeoutDelay) => {\n  let timeoutId;\n  return (...rest) => {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => callback.apply(this, rest), timeoutDelay);\n  };\n};\n\nfunction throttle (callback, delayBetweenFrames) {\n  let lastTime = 0;\n\n  return (...rest) => {\n    const now = new Date();\n    if (now - lastTime >= delayBetweenFrames) {\n      callback.apply(this, rest);\n      lastTime = now;\n    }\n  };\n}\n\nconst increase = (el) => {\n  let currentCount = parseInt(el.textContent, 10);\n  currentCount += 1;\n  el.textContent = currentCount;\n};\n\nconst decrease = (el) => {\n  let currentCount = parseInt(el.textContent, 10);\n  if (currentCount > 0) {\n    currentCount -= 1;\n    el.textContent = currentCount;\n  }\n};\n\nconst declension = (count) => {\n  if (count % 10 === 1 && count % 100 !== 11) {\n    return `${count} \u0442\u043E\u0432\u0430\u0440`;\n  }\n  if ((count % 10 >= 2 && count % 10 <= 4) && (count % 100 < 12 || count % 100 > 14)) {\n    return `${count} \u0442\u043E\u0432\u0430\u0440\u0430`;\n  }\n  return `${count} \u0442\u043E\u0432\u0430\u0440\u043E\u0432`;\n};\n\nexport { isEscapeKey, debounce, throttle, increase, decrease, declension };\n", "const cardTemplate = document.querySelector('#card').content.querySelector('.products__products-list-item');\nconst cartTemplate = document.querySelector('#card-cart').content.querySelector('.cart__cart-list-item');\nconst cardsList = document.querySelector('.products__products-list');\nconst cartList = document.querySelector('.cart__cart-list');\nconst renderProducts = (products) => {\n  const fragment = document.createDocumentFragment();\n  products.forEach(({id, name, price, image}) => {\n    const card = cardTemplate.cloneNode(true);\n    const cardImage = card.querySelector('.card__card-image');\n    const cardPrice = card.querySelector('.card__card-price');\n    const cardTitle = card.querySelector('.card__card-title');\n    const sources = card.querySelectorAll('source');\n    sources[0].srcset = `./images/mock-item${image}@1x.webp, ./images/mock-item${image}@2x.webp 2x`;\n    sources[1].srcset = `./images/mock-item${image}@1x.png, ./images/mock-item${image}@2x.png 2x`;\n    sources[2].srcset = `./images/mock-item-mobile${image}@1x.webp, ./images/mock-item-mobile${image}@2x.webp 2x`;\n    card.dataset.id = id;\n    cardImage.src = `./images/mock-item-mobile${image}@1x.png`;\n    cardImage.srcset = `./images/mock-item-mobile${image}@2x.png`;\n    cardPrice.textContent = `${price} \u20BD`;\n    cardTitle.textContent = name;\n\n    fragment.appendChild(card);\n  });\n  cardsList.appendChild(fragment);\n};\n\nconst renderToCart = ({id, name, price, image}) => {\n  const fragment = document.createDocumentFragment();\n\n  const card = cartTemplate.cloneNode(true);\n  const cardImage = card.querySelector('.cart-product__image');\n  const cardPrice = card.querySelector('.cart-product__price');\n  const cardTitle = card.querySelector('.cart-product__title');\n  const source = card.querySelector('source');\n  const counter = card.querySelector('.cart-product__product-counter');\n  source.srcset = `./images/mock-item-cart${image}@1x.webp, ./images/mock-item-cart${image}@2x.webp 2x`;\n  card.dataset.id = id;\n  cardImage.src = `./images/mock-item-cart${image}@1x.png`;\n  cardImage.srcset = `./images/mock-item-cart${image}@2x.png`;\n  cardPrice.textContent = `${price} \u20BD`;\n  cardTitle.textContent = name;\n  counter.textContent = 1;\n  counter.dataset.counter = id;\n\n  fragment.appendChild(card);\n\n  cartList.appendChild(fragment);\n};\n\n\nconst removeProducts = () => {\n  const elements = cardsList.querySelectorAll('.card');\n  elements.forEach((element) => element.remove());\n};\n\nexport { renderProducts, renderToCart, removeProducts };\n", "import { isEscapeKey, increase, decrease, declension } from './utils.js';\nimport { renderToCart } from './render-products.js';\n\nconst cartOpenButton = document.querySelector('.header-menu__button--cart');\nconst cartWrapper = document.querySelector('.cart__cart-background');\nconst cartList = cartWrapper.querySelector('.cart__cart-list');\nconst cartCloseButton = cartWrapper.querySelector('.cart__cart-close');\nconst cartClearAllButton = cartWrapper.querySelector('.cart__cart-clear');\nconst cartTotal = cartWrapper.querySelector('.cart__cart-total-price');\nconst productsTotalCart = cartWrapper.querySelector('.cart__cart-count-number');\nconst productsTotal = document.querySelector('.header-menu__button-text');\n\nconst onDocumentKeydown = (evt) => {\n  if (isEscapeKey(evt)) {\n    evt.preventDefault();\n    closeCart();\n  }\n};\n\nconst recalculate = (property) => {\n  const cartItems = cartWrapper.querySelectorAll('.cart__cart-list-item');\n  let total = 0;\n\n  cartItems.forEach((item) => {\n    if (property === 'quantity') {\n      const counter = parseInt(item.querySelector('.cart-product__product-counter').textContent, 10);\n      total += counter;\n    } else if (property === 'price') {\n      const price = parseFloat(item.querySelector('.cart-product__price').textContent.replace(' \u20BD', '')) || 0;\n      const counter = parseInt(item.querySelector('.cart-product__product-counter').textContent, 10) || 0;\n      total += price * counter;\n    }\n  });\n\n  if (property === 'quantity') {\n    productsTotalCart.textContent = declension(total);\n    productsTotal.textContent = total;\n  } else if (property === 'price') {\n    cartTotal.textContent = `${total} \u20BD`;\n  }\n};\n\nrecalculate('quantity');\n\nconst onCartCloseButtonClick = () => {\n  closeCart();\n  document.removeEventListener('keydown', onDocumentKeydown);\n};\n\nconst onCounterClick = (evt) => {\n  if (evt.target.classList.contains('cart-product__decrease')) {\n    decrease(evt.target.nextElementSibling);\n    if (parseInt(evt.target.nextElementSibling.textContent, 10) === 0) {\n      (evt.target.closest('.cart__cart-list-item')).remove();\n    }\n  }\n  if (evt.target.classList.contains('cart-product__increase')) {\n    increase(evt.target.previousElementSibling);\n  }\n  recalculate('price');\n  recalculate('quantity');\n};\n\nconst onCartActionButtonClick = (evt) => {\n  if (evt.target.classList.contains('cart-product__action')) {\n    (evt.target.closest('.cart__cart-list-item')).remove();\n    recalculate('price');\n    recalculate('quantity');\n  }\n};\n\nconst onCartClearAllButtonClick = () => {\n  cartList.innerHTML = '';\n  recalculate('price');\n  recalculate('quantity');\n};\n\n\nconst onTouchMove = (evt) => {\n  evt.preventDefault();\n};\n\nconst removeEventListeners = () => {\n  document.removeEventListener('keydown', onDocumentKeydown);\n  cartCloseButton.addEventListener('click', onCartCloseButtonClick);\n  cartClearAllButton.removeEventListener('click', onCartClearAllButtonClick);\n  cartList.removeEventListener('click' , onCounterClick);\n  cartWrapper.removeEventListener('click', onCartActionButtonClick);\n};\n\nconst addEventListeners = () => {\n  document.addEventListener('keydown', onDocumentKeydown);\n  cartCloseButton.addEventListener('click', onCartCloseButtonClick);\n  cartClearAllButton.addEventListener('click', onCartClearAllButtonClick);\n  cartList.addEventListener('click' , onCounterClick);\n  cartWrapper.addEventListener('click', onCartActionButtonClick);\n  // cartWrapper.addEventListener('touchmove', onTouchMove)\n};\n\nfunction closeCart () {\n  cartWrapper.classList.add('cart__cart-background--hidden');\n  removeEventListeners();\n}\n\nconst onCartOpenButtonClick = () => {\n  cartWrapper.classList.remove('cart__cart-background--hidden');\n  addEventListeners();\n  recalculate('price');\n  recalculate('quantity');\n};\n\ncartOpenButton.addEventListener('click', onCartOpenButtonClick);\n\nconst increaseCounter = (id) => {\n  const cartCards = [...cartWrapper.querySelectorAll('.cart__cart-list-item')];\n  const item = cartCards.find((product) => product.getAttribute('data-id') === id.toString());\n  if (item) {\n    const cardCounter = item.querySelector('.cart-product__product-counter');\n    increase(cardCounter);\n  }\n};\n\nconst addToCart = (product) => {\n  const cartCards = [...cartWrapper.querySelectorAll('.cart__cart-list-item')];\n  const existingProduct = cartCards.find((item) => item.getAttribute('data-id') === product.id.toString());\n  if (existingProduct) {\n    increaseCounter(product.id);\n  } else {\n    renderToCart(product);\n  }\n  recalculate('price');\n  recalculate('quantity');\n};\n\nexport { addToCart };\n"],
  "mappings": "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",
  "names": ["cartList", "cartList"]
}
